{"mappings":"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","sources":["./src/js/bookStorage.js","./src/js/bookInfo.js","./src/js/bookSearch.js","./src/js/api.js"],"sourcesContent":["'use strict'\r\n\r\nexport class BookStorage {\r\n    constructor() {\r\n        this._state = document.getElementById(\"readlist-state\");\r\n        this._markedBooksContainer = document.getElementById(\"to-read-marked\");\r\n        this._unmarkedBooksContainer = document.getElementById(\"to-read-unmarked\");\r\n\r\n        const { unmarkedBooks, markedBooks } = this.getLocalStorageData();\r\n\r\n        this._unmarkedBooks = unmarkedBooks;\r\n        this._markedBooks = markedBooks;\r\n\r\n        this.initRender();\r\n\r\n        window.onbeforeunload = this.saveBooks.bind(this);\r\n    }\r\n\r\n    saveBooks() {\r\n        localStorage.clear();\r\n        localStorage.setItem(\"booksInfo\", JSON.stringify({\r\n            unmarkedBooks: this._unmarkedBooks,\r\n            markedBooks: this._markedBooks\r\n        }));\r\n     }\r\n\r\n    initRender() {\r\n        this.setState();\r\n\r\n        // add books from storage\r\n        this._unmarkedBooks.forEach(item => this.renderUnmarkedBook(item));\r\n        this._markedBooks.forEach(item => this.renderMarkedBook(item));\r\n    }\r\n\r\n    setState() {\r\n        this._state.innerHTML = `<div class=\"right-column-header-state\" id=\"readlist-state\">\r\n                                    ${this._unmarkedBooks.length + this._markedBooks.length} books, ${this._markedBooks.length} read\r\n                                 </div>`;\r\n    }\r\n\r\n    renderMarkedBook(book) {\r\n        const newDiv = document.createElement(\"div\");\r\n        newDiv.setAttribute(\"class\", \"right-column-list-holder__elem marked\");\r\n        newDiv.setAttribute(\"id\", book.key);\r\n        newDiv.innerHTML = `<div class=\"right-column-list-holder__elem-title\">${book.title}</div>\r\n                            <div class=\"right-column-list-holder__elem-subtitle\">${book.subtitle !== undefined ? book.subtitle : \"no subtitle\"}</div>\r\n                            <div class=\"right-column-list-holder__elem-author\">${book.author_name[0] !== undefined ? book.author_name[0] : \"no info about author\"}</div>\r\n                            <div class=\"right-column-list-holder__elem-actions\">\r\n                                <button class=\"right-column-list-holder__elem-actions__button\" data-action=\"unmark\">Unmark</button>\r\n                                <button class=\"right-column-list-holder__elem-actions__button\" data-action=\"remove\">Remove from list</button>\r\n                            </div>`;\r\n        this._markedBooksContainer.appendChild(newDiv);\r\n        const buttons = document.getElementById(book.key);\r\n        buttons.addEventListener(\"click\", this.processAction.bind(this));\r\n    }\r\n\r\n    renderUnmarkedBook(book) {\r\n        const newDiv = document.createElement(\"div\");\r\n        newDiv.setAttribute(\"class\", \"right-column-list-holder__elem\");\r\n        newDiv.setAttribute(\"id\", book.key);\r\n        newDiv.innerHTML = `<div class=\"right-column-list-holder__elem-title\">${book.title}</div>\r\n                            <div class=\"right-column-list-holder__elem-subtitle\">${book.subtitle !== undefined ? book.subtitle : \"no subtitle\"}</div>\r\n                            <div class=\"right-column-list-holder__elem-author\">${book.author_name !== undefined && book.author_name[0] !== undefined ? book.author_name[0] : \"no info about author\"}</div>\r\n                            <div class=\"right-column-list-holder__elem-actions\">\r\n                                <button class=\"right-column-list-holder__elem-actions__button\" data-action=\"mark\">Mark as read</button>\r\n                                <button class=\"right-column-list-holder__elem-actions__button\" data-action=\"remove\">Remove from list</button>\r\n                            </div>`;\r\n        this._unmarkedBooksContainer.appendChild(newDiv);\r\n        const buttons = document.getElementById(book.key);\r\n        buttons.addEventListener(\"click\", this.processAction.bind(this));\r\n    }\r\n\r\n    isInStorage(id) {\r\n        return this._unmarkedBooks.concat(this._markedBooks).some(item => item.key === id);\r\n    }\r\n\r\n    removeBook(container) {\r\n\r\n        if (container.classList.contains(\"marked\")) {\r\n            const bookToDeleteIndex = this._markedBooks.findIndex(item => item.key === container.id);\r\n            this._markedBooks.splice(bookToDeleteIndex, 1);\r\n        } else {\r\n            const bookToDeleteIndex = this._unmarkedBooks.findIndex(item => item.key === container.id);\r\n            this._unmarkedBooks.splice(bookToDeleteIndex, 1);\r\n        }\r\n\r\n        container.remove();\r\n        this.setState();\r\n    }\r\n\r\n    markBook(container, {target}) {\r\n\r\n        container.classList.add(\"marked\");\r\n        target.innerText = \"Unmark\";\r\n        target.dataset.action = \"unmark\";\r\n\r\n        const bookToMarkIndex = this._unmarkedBooks.findIndex(item => item.key === container.id);\r\n        this._markedBooks.push(this._unmarkedBooks[bookToMarkIndex]);\r\n\r\n        this._unmarkedBooks.splice(bookToMarkIndex, 1);\r\n        this._markedBooksContainer.insertAdjacentElement('beforeend', container); // перемещаем в конец отмеченных\r\n    }\r\n\r\n    unmarkBook(container, {target}) {\r\n\r\n        container.classList.remove(\"marked\");\r\n        target.innerText = \"Mark as read\";\r\n        target.dataset.action = \"mark\";\r\n\r\n        const bookToUnmarkIndex = this._markedBooks.findIndex(item => item.key === container.id);\r\n        this._unmarkedBooks.push(this._markedBooks[bookToUnmarkIndex]);\r\n\r\n        this._markedBooks.splice(bookToUnmarkIndex, 1);\r\n        this._unmarkedBooksContainer.insertAdjacentElement('beforeend', container); // перемещаем в конец неотмеченных\r\n    }\r\n\r\n    processAction(event) {\r\n        if (event.target.nodeName === \"BUTTON\") {\r\n            const container = event.target.parentNode.parentNode;\r\n            if (event.target.dataset.action === \"mark\" || event.target.dataset.action === \"unmark\") {\r\n                if (event.target.dataset.action === \"mark\") {\r\n                    this.markBook(container, event);\r\n                } else {\r\n                    this.unmarkBook(container, event);\r\n                }\r\n            } else {\r\n                this.removeBook(container);\r\n            }\r\n            this.setState();\r\n        }\r\n    }\r\n\r\n    addBook(book) {\r\n        let added = false;\r\n        if (!this.isInStorage(book.key)) {\r\n            added = true;\r\n            this._unmarkedBooks.push(book);\r\n            this.renderUnmarkedBook(book);\r\n            this.setState();\r\n        }\r\n        return added;\r\n    }\r\n\r\n    getLocalStorageData() {\r\n        let result;\r\n\r\n        let localStorageJson = localStorage.getItem(\"booksInfo\");\r\n\r\n        if (localStorageJson === null || localStorageJson === \"[]\") { // Данных нет\r\n            localStorage.setItem(\"booksInfo\", JSON.stringify({\r\n                unmarkedBooks: [],\r\n                markedBooks: []\r\n            }));\r\n            result = {\r\n                unmarkedBooks: [],\r\n                markedBooks: []\r\n            }\r\n        } else { // Данные есть\r\n            try {\r\n                result = JSON.parse(localStorage.getItem(\"booksInfo\"));\r\n            } catch (e) {\r\n                console.log(`localStorage JSON parse error: ${e.message}`);\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n","'use strict'\r\n\r\nimport {BookStorage} from \"./bookStorage\";\r\n\r\nexport class BookInfo {\r\n    constructor() {\r\n        this._infoContainer = document.getElementById(\"book-info-holder\");\r\n        this._storage = new BookStorage();\r\n        this._currentBook = null;\r\n        this._messageContainer = document.getElementById(\"error-message\");\r\n\r\n    }\r\n\r\n    showInfo(item) {\r\n        this._messageContainer.style.display = \"none\";\r\n        this._infoContainer.innerHTML = `<h2 class=\"center-column-holder-title>\">${item.title}</h2>\r\n                    <div class=\"center-column-holder-subtitle\">${item.subtitle !== undefined ? item.subtitle : \"\"}</div>\r\n                    <div class=\"center-column-holder-info\">\r\n                        <div class=\"center-column-holder-info_langs\">Languages available: ${item.language !== undefined ? item.language.join(\", \") : \"no information\"}</div>\r\n                        <div class=\"center-column-holder-info_full-text\">Full text available: ${item.has_fulltext ? \"yes\" : \"no\"}</div>\r\n                        <div class=\"center-column-holder-info_first-publish\">First publish year: ${item.first_publish_year !== undefined ? item.first_publish_year : \"no information\"}</div>\r\n                        <div class=\"center-column-holder-info_years-published\">Year published: ${item.publish_year !== undefined ? item.publish_year.join(\", \") : \"no information\"}</div>\r\n                    </div>\r\n                    <button class=\"center-column-holder-button\" id=\"add-book\">Add book to Read List</button>`;\r\n        this._currentBook = item;\r\n\r\n        const addBookButton = document.getElementById(\"add-book\");\r\n        addBookButton.addEventListener(\"click\", () => {\r\n            if (!this._storage.addBook(this._currentBook)) {\r\n                this.showMessageError();\r\n            }\r\n        });\r\n    }\r\n\r\n    showMessageError() {\r\n        if (this._messageContainer.style.display !== \"block\") {\r\n            this._messageContainer.style.display = \"block\";\r\n\r\n            setTimeout(() => {\r\n                this._messageContainer.style.display = \"none\";\r\n            }, 5000);\r\n        }\r\n    }\r\n}","'use strict'\r\n// TODO: search without enter (3+ chars, debounce)\r\n\r\nimport { BookInfo } from \"./bookInfo\";\r\n\r\nexport class BookSearch {\r\n    constructor(api) {\r\n        this._api = api;\r\n        this._searchInput = document.getElementById(\"search-input\");\r\n        this._booksList = document.getElementById(\"books-list\");\r\n        this._resultsInfo = document.getElementById(\"results-info\");\r\n        this._loadingMessage = document.getElementById(\"loading-message\");\r\n        this._resultContainer = document.getElementById(\"result-container\");\r\n\r\n        this._infoUI = new BookInfo();\r\n        this._results = [];\r\n        this._numFound = 0;\r\n        this._fetchBlock = false;\r\n        this._selectedPage = null;\r\n        this._searchInput.value = \"\";\r\n        this._currentPage = 0;\r\n        this._currentRequest = \"\";\r\n        this._debounceTimeoutID = null;\r\n\r\n        this._booksList.addEventListener(\"click\", event => {\r\n            if (event.target.classList.contains(\"left-column-result-wrapper-results__elem\")) {\r\n                this._infoUI.showInfo(this._results[event.target.dataset.elemId]);\r\n                this.selectItem(event.target);\r\n            }\r\n        });\r\n\r\n        this._searchInput.addEventListener(\"input\", event => {\r\n            if (this._searchInput.value.length >= 3) {\r\n\r\n                if (this._debounceTimeoutID) {\r\n                    this._api.stopFetch();\r\n                    clearTimeout(this._debounceTimeoutID);\r\n                }\r\n\r\n                this._debounceTimeoutID = setTimeout(() => {\r\n                    this._debounceTimeoutID = null;\r\n                    this.processSearch(event);\r\n                }, 500);\r\n            }\r\n        });\r\n\r\n        this._resultContainer.addEventListener(\"scroll\", () => {\r\n            if (!this._fetchBlock && this._resultContainer.scrollTop + this._resultContainer.clientHeight + 6000 > this._resultContainer.scrollHeight) {\r\n                this.loadData();\r\n            }\r\n        });\r\n    }\r\n\r\n    processSearch(event) {\r\n        event.preventDefault();\r\n        if (this._currentRequest !== this._searchInput.value && this._searchInput.value !== \"\") {\r\n            this._results = [];\r\n            this._booksList.innerHTML = \"\";\r\n            this._currentRequest = this._searchInput.value;\r\n            this.loadData();\r\n        }\r\n    }\r\n\r\n    loadData() {\r\n        this.showLoadingMessage();\r\n        this._fetchBlock = true;\r\n        this._api.search(this._currentRequest, this._currentPage + 1).then(response => {\r\n            this._results = this._results.concat(response.docs);\r\n            this._numFound = response.numFound;\r\n\r\n            this._currentPage++;\r\n            this.renderSearchResult(response.docs);\r\n            if (this._results.length < response.numFound) {\r\n                this._fetchBlock = false;\r\n            }\r\n            this.hideLoadingMessage();\r\n        }, err => {\r\n            this.processSearchError(err);\r\n            this.hideLoadingMessage();\r\n        });\r\n    }\r\n\r\n    renderSearchResult(data) {\r\n        this._booksList.innerHTML += this.makeSearchResult(data);\r\n        this._resultsInfo.innerHTML = this.makeStats();\r\n    }\r\n\r\n    makeStats() {\r\n        return `<span class=\"left-column-results-bottom-info_elem\">\r\n                    Found: ${this._numFound}\r\n               </span>\r\n               <span class=\"left-column-results-bottom-info_elem\">\r\n                   Loaded: ${this._results.length}\r\n               </span>`;\r\n    }\r\n\r\n    makeSearchResult(data) {\r\n        let HTML = \"\";\r\n        if (data.length !== 0) {\r\n            data.forEach((item, index) => {\r\n                HTML += `<div class=\"left-column-result-wrapper-results__elem\" data-elem-id = \"${index + (this._currentPage - 1) * 100}\">\r\n                        ${item.title} (${item.language === undefined ? \"no info\" : item.language.join(\", \")})\r\n                        </div>`;\r\n            });\r\n        } else {\r\n            HTML = `<div class=\"left-column-result-wrapper-results__error\">Nothing found!</div>`\r\n        }\r\n\r\n        return HTML;\r\n    }\r\n\r\n    processSearchError(err) {\r\n        console.log(err);\r\n    }\r\n\r\n    selectItem(item) {\r\n        if (this._selectedPage) {\r\n            this._selectedPage.classList.remove(\"left-column-result-wrapper__elem_selected\");\r\n        }\r\n\r\n        item.classList.add(\"left-column-result-wrapper__elem_selected\");\r\n        this._selectedPage = item;\r\n    }\r\n\r\n    showLoadingMessage() {\r\n        this._loadingMessage.style.display = \"block\";\r\n    }\r\n\r\n    hideLoadingMessage() {\r\n        this._loadingMessage.style.display = \"none\";\r\n    }\r\n}","'use strict'\r\n\r\nexport class Api {\r\n    constructor() {\r\n        this.controller = null;\r\n    }\r\n\r\n    async search(q, pageNum) {\r\n        const url = `https://openlibrary.org/search.json?q=${q}&page=${pageNum}`;\r\n        console.log(`fetch url: ${url}`);\r\n        this.controller = new AbortController();\r\n        const result = await fetch(url, {signal: this.controller.signal});\r\n        return await result.json();\r\n    }\r\n\r\n    stopFetch() {\r\n        if (this.controller) this.controller.abort();\r\n    }\r\n}"],"names":["$081ad0ff428b01c90575ffba014371aa$export$BookStorage","constructor","this","_state","document","getElementById","_markedBooksContainer","_unmarkedBooksContainer","unmarkedBooks","markedBooks","getLocalStorageData","_unmarkedBooks","_markedBooks","initRender","window","onbeforeunload","saveBooks","bind","localStorage","clear","setItem","JSON","stringify","setState","forEach","item","renderUnmarkedBook","renderMarkedBook","innerHTML","length","book","newDiv","createElement","setAttribute","key","title","undefined","subtitle","author_name","appendChild","addEventListener","processAction","isInStorage","id","concat","some","removeBook","container","classList","contains","bookToDeleteIndex","findIndex","splice","remove","markBook","target","add","innerText","dataset","action","bookToMarkIndex","push","insertAdjacentElement","unmarkBook","bookToUnmarkIndex","event","nodeName","parentNode","addBook","added","result","localStorageJson","getItem","parse","e","console","log","message","$697906ead07ee7076a0e026251b108ab$export$BookInfo","_infoContainer","_storage","_currentBook","_messageContainer","showInfo","style","display","language","join","has_fulltext","first_publish_year","publish_year","showMessageError","setTimeout","api","_api","_searchInput","_booksList","_resultsInfo","_loadingMessage","_resultContainer","_infoUI","_results","_numFound","_fetchBlock","_selectedPage","value","_currentPage","_currentRequest","_debounceTimeoutID","elemId","selectItem","stopFetch","clearTimeout","processSearch","scrollTop","clientHeight","scrollHeight","loadData","preventDefault","showLoadingMessage","search","then","response","docs","numFound","renderSearchResult","hideLoadingMessage","err","processSearchError","data","makeSearchResult","makeStats","HTML","index","controller","q","pageNum","url","AbortController","fetch","signal","json","abort"],"version":3,"file":"index.ff913026.js.map"}